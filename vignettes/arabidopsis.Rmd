---
title: "*Arabidopsis thaliana* case study"
author: "Zebulun Arendsee"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{*Arabidopsis thaliana* case study}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## Select relatives to search

```{r}
library(phylostratr)

# Get stratified relatives represented in UniProt
strata <- uniprot_cousins(3702)

cfilter <- make_do_if_over(3, take_first)
strata2 <- clear_uncle(strata, 2759, 33154) %>%
    lapply(cfilter) %>%
    add_representative(scinames=c('Homo sapiens', 'Saccharomyces cerevisiae'))

strata3 <- as_named_strata(strata2)
print_strata(strata3)

```

```{r, eval=FALSE}
uniprot_retrieve_genomes(unname(unlist(strata2)))
```


```{r, eval=FALSE}
library(phylostratr)
library(magrittr)

shits <- system.file(
    'extdata',
    'araport11',
    'araport11_subset9.tab',
    package='phylostratr'
) %>%
  load_hittable %>%
  get_max_hit

shits %>%
    dplyr::group_by(staxid) %>%
    dplyr::summarize(n = n()) -> x
```
